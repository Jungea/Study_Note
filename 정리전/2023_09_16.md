

- Servlet
	- 동적 웹 페이지를 생성하데 사용되는 자바 웹 애플리케이션 프로그래밍 기술
	- 요청과 응답의 흐름을 간단한 메소드 호출만으로 체계적으로 다룰 수 있게 해주는 기술
- Servlet Container
	- 서블릿 생명주기 관리 / 통신 / 멀티스레딩
- Spring Container
- Dispatcher Servlet
- DelegatingFilterProxy



# Spring Security
![[Pasted image 20230916152940.png]]
- 모든 Request들은 Filter Chain(Filter 여러개)을 거쳐 Dispatcher Servlet에 도착
- FilterChainProxy
	- DelegatingFilterProxy로부터 요청을 위임받아 실제로 보안 처리
	- 스프링 시큐리티 초기화 시 생성되는 필터들을 관리, 제어
	- 사용자 정의 필터를 생성하여 기본 필터 전/후로 추가 가능
	- 마지막 필터까지 인증 및 인가 예외가 발생하지 않으면 보안 통과


Security filter chain:
```java
DisableEncodeUrlFilter
WebAsyncManagerIntegrationFilter
SecurityContextHolderFilter
HeaderWriterFilter
LogoutFilter
JwtFilter
AjaxLoginProcessingFilter
RequestCacheAwareFilter
SecurityContextHolderAwareRequestFilter
AnonymousAuthenticationFilter
SessionManagementFilter
ExceptionTranslationFilter
AuthorizationFilter
```


## 로그인
![[Pasted image 20230916161149.png]]
- AjaxLoginConfigurer : 로그인 설정
- loginProcessingUrl : /api/users/login 
- AjaxLoginProcessingFilter extends AbstractAuthenticationProcessingFilter
	- http.addFilterBefore(getAuthenticationFilter(), UsernamePasswordAuthenticationFilter.class);
- AuthenticationSuccessHandler
- AuthenticationFailureHandler




로그인 URL → permit all → `AjaxLoginProcessingFilter` → `AjaxAuthenticationProvider` → `DtUserDetailsService` →

1. `AuthenticationEntryPoint` (인증X)
2. `AccessDeniedHandler` (인증 O, 권한X)
 커스텀 필터가 실행 되고 인증이 완료 되었기 때문에 UsernamePasswordAuthenticationFilter 수행되면서 인증완료된 상태이면 인증 로직이 수행되지 않고 자연스럽게 통과 